import{_ as I}from"./form.vue_vue_type_script_setup_true_lang-C_VQGC98.js";import{aT as s,l as W,k as i,z as A,Q as S,aU as k,aE as g,ah as q}from"./index-DLbSnZ-2.js";import{C as P}from"./common-MP0nqKMS.js";import"./index-CqpMF8Ft.js";const F=t=>s.request("get","/system/configs",{params:t}),L=t=>s.request("get",`/system/config/${t}`),O=(t,o)=>s.request("put",`/system/config/${t}`,{data:o}),T=()=>s.request("delete","/system/configs/cache");function $(){const t={total:0,pageSize:10,currentPage:1,background:!0},o=W({configKey:void 0,configName:void 0,isAllowChange:void 0}),c=i(),f=i([]),r=i(!0),p=i([]),d=[{label:"参数编号",prop:"configId",minWidth:60},{label:"参数名称",prop:"configName",minWidth:120},{label:"参数键",prop:"configKey",minWidth:120,showOverflowTooltip:!0},{label:"参数值",prop:"configValue",minWidth:150},{label:"参数选项",prop:"configOptions",minWidth:120},{label:"允许更改",prop:"isAllowChangeStr",minWidth:100},{label:"备注",prop:"remark",minWidth:120,showOverflowTooltip:!0},{label:"操作",fixed:"right",width:120,slot:"operation"}];function u(){t.currentPage=1,a()}function m(e,n){e&&(e.resetFields(),n.getTableRef().clearSort(),u())}async function a(){P.fillPaginationParams(o,t),r.value=!0;const{data:e}=await F(S(o)).finally(()=>{r.value=!1});f.value=e.rows,t.total=e.total}async function h(){await T().then(()=>{g("刷新缓存成功",{type:"success"}),a()})}async function w(e,n){const l={configValue:e.configValue};await O(e.configId,l).then(()=>{g(`您成功修改了配置：${e.configName}`,{type:"success"}),n(),a()})}async function y(e){const{data:n}=await L(e.configId);k({title:"修改配置",props:{formInline:n},width:"40%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>q(I,{ref:c,formInline:n}),beforeSure:(l,{options:b})=>{const C=c.value.getFormRuleRef(),R=b.props.formInline;C.validate(v=>{v&&w(R,l)})}})}return A(()=>{a()}),{searchFormParams:o,pageLoading:r,columns:d,dataList:f,pagination:t,multipleSelection:p,getList:a,onSearch:u,resetForm:m,handleRefresh:h,openDialog:y}}export{$ as useHook};
