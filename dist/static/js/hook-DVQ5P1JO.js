import{x as w,l as M,k as r,z as C,e as R,n as W,Q as f,aE as u,aw as k,m as H,r as L}from"./index-DLbSnZ-2.js";import{C as i}from"./common-MP0nqKMS.js";import{g as z,d as b,e as A}from"./post-CAgdbTIk.js";import"./index-CqpMF8Ft.js";const h=H().dictionaryMap["common.status"];function E(){const p={prop:"postSort",order:"ascending"},a={total:0,pageSize:10,currentPage:1,background:!0},c=w({get(){return t.beginTime&&t.endTime?[t.beginTime,t.endTime]:null},set(e){(e==null?void 0:e.length)===2?(t.beginTime=e[0],t.endTime=e[1]):(t.beginTime=void 0,t.endTime=void 0)}}),t=M({postCode:"",postName:"",status:void 0}),d=r([]),m=r(!0),n=r([]),l=r(p),y=[{type:"selection",align:"left"},{label:"岗位编号",prop:"postId",minWidth:100},{label:"岗位编码",prop:"postCode",minWidth:120},{label:"岗位名称",prop:"postName",minWidth:120},{label:"岗位排序",prop:"postSort",sortable:"custom",minWidth:120},{label:"状态",prop:"status",minWidth:120,cellRenderer:({row:e,props:s})=>R(L("el-tag"),{size:s.size,type:h[e.status].cssTag,effect:"plain"},{default:()=>[h[e.status].label]})},{label:"创建时间",minWidth:160,prop:"createTime",sortable:"custom",formatter:({createTime:e})=>W(e).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",width:140,slot:"operation"}];function T(e){l.value=e,a.currentPage=1,o()}async function g(e){e.getTableRef().sort("postSort","ascending")}function P(e,s){e&&(e.resetFields(),t.beginTime=void 0,t.endTime=void 0,g(s))}async function o(){m.value=!0,i.fillSortParams(t,l.value),i.fillPaginationParams(t,a);const{data:e}=await z(f(t)).finally(()=>{m.value=!1});d.value=e.rows,a.total=e.total}async function S(){l.value!=null&&i.fillSortParams(t,l.value),i.fillPaginationParams(t,a),c.value&&i.fillTimeRangeParams(t,c.value),A(f(t),"岗位数据.xlsx")}async function x(e){await b([e.postId]).then(()=>{u(`您删除了编号为${e.postId}的这条岗位数据`,{type:"success"}),o()})}async function v(e){if(n.value.length===0){u("请选择需要删除的数据",{type:"warning"});return}k.confirm(`确认要<strong>删除</strong>编号为<strong style='color:var(--el-color-primary)'>[ ${n.value} ]</strong>的岗位数据吗?`,"系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,draggable:!0}).then(async()=>{await b(n.value.map(s=>s.postId)).then(()=>{u(`您删除了编号为[ ${n.value} ]的岗位数据`,{type:"success"}),o()})}).catch(()=>{u("取消删除",{type:"info"}),e.getTableRef().clearSelection()})}return C(o),{searchFormParams:t,pageLoading:m,columns:y,dataList:d,pagination:a,defaultSort:p,timeRange:c,multipleSelection:n,onSearch:g,onSortChanged:T,exportAllExcel:S,getPostList:o,resetForm:P,handleDelete:x,handleBulkDelete:v}}export{E as usePostHook};
