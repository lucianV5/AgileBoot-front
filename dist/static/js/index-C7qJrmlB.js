import{useRole as E}from"./hook-FAEJdPHC.js";import{P as K}from"./index-A5l2LtVK.js";import{d as A,k as u,r,c as F,o as O,e as l,i as a,u as e,E as m,g as p,av as j,_ as q}from"./index-DLbSnZ-2.js";import{d as G}from"./delete-Ce0TSdK5.js";import{a as H,d as J}from"./add-circle-line-CH7bT49i.js";import{d as Q}from"./search-DMYzPYXy.js";import{d as W}from"./refresh-C_2cW1e5.js";import{g as X}from"./role-Bt7LqOtR.js";import{_ as Y}from"./role-form-modal.vue_vue_type_script_setup_true_lang-C0ORD7Ea.js";import"./menu-1b5jiDSW.js";import"./hooks-_COpLDj5.js";import"./epTheme-Cax6E919.js";import"./VDialog-B5iLIfwi.js";const Z={class:"main"},ee=A({name:"SystemRole",__name:"index",setup(oe){const _=u(),{form:s,loading:g,columns:x,dataList:S,pagination:$,onSearch:b,resetForm:R,menuTree:w,getMenuTree:h,handleDelete:P,handleSelectionChange:T,handleSizeChange:L,handleCurrentChange:N}=E(),v=u("add"),c=u(!1),C=u();async function y(V,o){debugger;try{if(await h(),o){const{data:n}=await X(o.roleId);o.selectedMenuList=n.selectedMenuList,o.selectedDeptList=n.selectedDeptList}}catch(n){console.error(n),j.error((n==null?void 0:n.message)||"加载菜单失败")}v.value=V,C.value=o,c.value=!0}return(V,o)=>{const n=r("el-input"),d=r("el-form-item"),k=r("el-option"),D=r("el-select"),i=r("el-button"),I=r("el-form"),M=r("el-popconfirm"),U=r("pure-table");return O(),F("div",Z,[l(I,{ref_key:"formRef",ref:_,inline:!0,model:e(s),class:"search-form bg-bg_color w-[99/100] pl-8 pt-[12px]"},{default:a(()=>[l(d,{label:"角色名称：",prop:"name"},{default:a(()=>[l(n,{modelValue:e(s).roleName,"onUpdate:modelValue":o[0]||(o[0]=t=>e(s).roleName=t),placeholder:"请输入角色名称",clearable:"",class:"!w-[200px]"},null,8,["modelValue"])]),_:1}),l(d,{label:"角色标识：",prop:"code"},{default:a(()=>[l(n,{modelValue:e(s).roleKey,"onUpdate:modelValue":o[1]||(o[1]=t=>e(s).roleKey=t),placeholder:"请输入角色标识",clearable:"",class:"!w-[180px]"},null,8,["modelValue"])]),_:1}),l(d,{label:"状态：",prop:"status"},{default:a(()=>[l(D,{modelValue:e(s).status,"onUpdate:modelValue":o[2]||(o[2]=t=>e(s).status=t),placeholder:"请选择状态",clearable:"",class:"!w-[180px]"},{default:a(()=>[l(k,{label:"已启用",value:"1"}),l(k,{label:"已停用",value:"0"})]),_:1},8,["modelValue"])]),_:1}),l(d,null,{default:a(()=>[l(i,{type:"primary",icon:e(m)(e(Q)),loading:e(g),onClick:e(b)},{default:a(()=>o[6]||(o[6]=[p(" 搜索 ")])),_:1,__:[6]},8,["icon","loading","onClick"]),l(i,{icon:e(m)(e(W)),onClick:o[3]||(o[3]=t=>e(R)(_.value))},{default:a(()=>o[7]||(o[7]=[p(" 重置 ")])),_:1,__:[7]},8,["icon"])]),_:1})]),_:1},8,["model"]),l(e(K),{title:"角色列表",columns:e(x),onRefresh:e(b)},{buttons:a(()=>[l(i,{type:"primary",icon:e(m)(e(J)),onClick:o[4]||(o[4]=t=>y("add"))},{default:a(()=>o[8]||(o[8]=[p(" 新增角色 ")])),_:1,__:[8]},8,["icon"])]),default:a(({size:t,dynamicColumns:z})=>[l(U,{border:"","align-whole":"center",showOverflowTooltip:"","table-layout":"auto",loading:e(g),size:t,adaptive:"",data:e(S),columns:z,pagination:e($),paginationSmall:t==="small","header-cell-style":{background:"var(--el-table-row-hover-bg-color)",color:"var(--el-text-color-primary)"},onSelectionChange:e(T),onPageSizeChange:e(L),onPageCurrentChange:e(N)},{operation:a(({row:f})=>[l(i,{class:"reset-margin",link:"",type:"primary",size:t,icon:e(m)(e(H)),onClick:B=>y("update",f)},{default:a(()=>o[9]||(o[9]=[p(" 修改 ")])),_:2,__:[9]},1032,["size","icon","onClick"]),l(M,{title:`是否确认删除角色名称为${f.roleName}的这条数据`,onConfirm:B=>e(P)(f)},{reference:a(()=>[l(i,{class:"reset-margin",link:"",type:"primary",size:t,icon:e(m)(e(G))},{default:a(()=>o[10]||(o[10]=[p(" 删除 ")])),_:2,__:[10]},1032,["size","icon"])]),_:2},1032,["title","onConfirm"])]),_:2},1032,["loading","size","data","columns","pagination","paginationSmall","onSelectionChange","onPageSizeChange","onPageCurrentChange"])]),_:1},8,["columns","onRefresh"]),l(Y,{modelValue:c.value,"onUpdate:modelValue":o[5]||(o[5]=t=>c.value=t),type:v.value,row:C.value,"menu-options":e(w)},null,8,["modelValue","type","row","menu-options"])])}}}),_e=q(ee,[["__scopeId","data-v-44732b5a"]]);export{_e as default};
