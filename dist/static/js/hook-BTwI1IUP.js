import{l as R,k as n,x as W,M as m,aV as f,z as k,e as H,n as Y,aE as l,aW as $,aU as x,r as z,ah as O}from"./index-DLbSnZ-2.js";import{_ as S}from"./form.vue_vue_type_script_setup_true_lang-DLB5lvFf.js";import{a as r,d as T,b as _,c as j,u as C}from"./dept-CNyEMDwu.js";import{u as P}from"./hooks-_COpLDj5.js";import"./index-M2tAlyFk.js";function G(){const s=R({deptName:"",status:null}),d=n(),p=n([]),o=W(()=>{let a=[...p.value];return m(s.deptName)||(a=a.filter(e=>e.deptName.includes(s.deptName))),m(s.status)||(a=a.filter(e=>e.status===s.status)),[...f(a)]}),i=n(!0),{tagStyle:h}=P(),N=[{label:"部门名称",prop:"deptName",width:240,align:"left"},{label:"部门编号",prop:"id",width:100,align:"center"},{label:"部门负责人",prop:"leaderName",minWidth:70},{label:"状态",prop:"status",minWidth:100,cellRenderer:({row:a,props:e})=>H(z("el-tag"),{size:e.size,style:h.value(a.status)},{default:()=>[a.status===1?"启用":"停用"]})},{label:"排序",prop:"orderNum",minWidth:70},{label:"创建时间",minWidth:200,prop:"createTime",formatter:({createTime:a})=>Y(a).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",width:240,slot:"operation"}];function g(a){a&&(a.resetFields(),t())}async function t(){i.value=!0;const{data:a}=await r().finally(()=>{i.value=!1});p.value=a}async function D(a,e){await j(a).then(()=>{l(`您新增了部门:${a.deptName}`,{type:"success"}),e(),t()})}async function b(a,e){await C(a.id,a).then(()=>{l(`您更新了部门${a.deptName}`,{type:"success"}),e(),t()})}async function y(a="新增",e){const{data:A}=await r(),I=$(f(A),"status");a==="编辑"&&(e=(await _(e.id+"")).data),x({title:`${a}部门`,props:{formInline:{id:(e==null?void 0:e.id)??0,parentId:(e==null?void 0:e.parentId)??0,deptName:(e==null?void 0:e.deptName)??"",leaderName:(e==null?void 0:e.leaderName)??"",phone:(e==null?void 0:e.phone)??"",email:(e==null?void 0:e.email)??"",orderNum:(e==null?void 0:e.orderNum)??0,status:(e==null?void 0:e.status)??1},higherDeptOptions:[...I]},width:"40%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,contentRenderer:()=>O(S,{ref:d}),beforeSure:(u,{options:F})=>{const L=d.value.getRef(),c=F.props.formInline;L.validate(M=>{M&&(a==="新增"?D(c,u):b(c,u))})}})}async function v(a){await T(a.id).then(()=>{l(`您删除了部门${a.deptName}`,{type:"success"}),t()})}return k(()=>{t()}),{searchFormParams:s,loading:i,columns:N,dataList:o,onSearch:t,resetForm:g,openDialog:y,handleDelete:v}}export{G as useHook};
