import{V as I}from"./VDialog-B5iLIfwi.js";import{d as K,x as O,l as B,m as F,k as c,r as d,h as g,o as y,i as r,e as a,c as M,F as j,A,u as m,g as D,t as E,bj as L,av as b}from"./index-DLbSnZ-2.js";import{b as T,u as H}from"./role-Bt7LqOtR.js";const $={name:"RoleFormModal"},P=K({...$,props:{type:{},modelValue:{type:Boolean},row:{},menuOptions:{}},emits:["update:modelValue","success"],setup(v,{emit:h}){const n=v,_=h,u=O({get:()=>n.modelValue,set(t){_("update:modelValue",t)}}),e=B({roleId:0,dataScope:"",menuIds:[],remark:"",roleKey:"",roleName:"",roleSort:1,status:""}),i=F().dictionaryMap["common.status"]||{},w={roleName:[{required:!0,message:"角色名称不能为空"}],roleKey:[{required:!0,message:"权限标识不能为空"}],roleSort:[{required:!0,message:"角色序号不能为空"}]},k=c();function C(){var t;n.row?(Object.assign(e,n.row),e.menuIds=n.row.selectedMenuList):(t=k.value)==null||t.resetFields()}const V=c();function x(){e.menuIds=V.value.getCheckedKeys(!1)}const p=c(!1);async function N(){try{p.value=!0,n.type==="add"?await T(e):n.type==="update"&&await H(e),b.info("提交成功"),u.value=!1,_("success")}catch(t){console.error(t),b.error((t==null?void 0:t.message)||"提交失败")}finally{p.value=!1}}return(t,o)=>{const f=d("el-input"),s=d("el-form-item"),S=d("el-input-number"),R=d("el-radio"),U=d("el-radio-group"),q=d("el-form");return y(),g(I,{"show-full-screen":"","fixed-body-height":"","use-body-scrolling":"",title:t.type==="add"?"新增角色":"更新角色",modelValue:u.value,"onUpdate:modelValue":o[5]||(o[5]=l=>u.value=l),loading:p.value,onConfirm:N,onCancel:o[6]||(o[6]=l=>u.value=!1),onOpened:C},{default:r(()=>[a(q,{model:e,"label-width":"120px",rules:w,ref_key:"formRef",ref:k},{default:r(()=>[a(s,{prop:"roleName",label:"角色名称",required:"","inline-message":""},{default:r(()=>[a(f,{modelValue:e.roleName,"onUpdate:modelValue":o[0]||(o[0]=l=>e.roleName=l)},null,8,["modelValue"])]),_:1}),a(s,{prop:"roleKey",label:"权限字符",required:""},{default:r(()=>[a(f,{modelValue:e.roleKey,"onUpdate:modelValue":o[1]||(o[1]=l=>e.roleKey=l)},null,8,["modelValue"])]),_:1}),a(s,{prop:"roleSort",label:"角色顺序",required:""},{default:r(()=>[a(S,{min:1,modelValue:e.roleSort,"onUpdate:modelValue":o[2]||(o[2]=l=>e.roleSort=l)},null,8,["modelValue"])]),_:1}),a(s,{prop:"status",label:"角色状态"},{default:r(()=>[a(U,{modelValue:e.status,"onUpdate:modelValue":o[3]||(o[3]=l=>e.status=l)},{default:r(()=>[(y(!0),M(j,null,A(Object.keys(m(i)),l=>(y(),g(R,{key:l,label:m(i)[l].value},{default:r(()=>[D(E(m(i)[l].label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(s,{label:"菜单权限",prop:"menuIds"},{default:r(()=>[a(m(L),{ref_key:"treeRef",ref:V,props:{label:"menuName",children:"children"},data:n.menuOptions,"node-key":"id","check-strictly":"","show-checkbox":"","default-expand-all":"","check-on-click-node":"","expand-on-click-node":!1,"default-checked-keys":e.menuIds,onCheckChange:x,style:{width:"100%"}},null,8,["data","default-checked-keys"])]),_:1}),a(s,{prop:"remark",label:"备注",style:{"margin-bottom":"0"}},{default:r(()=>[a(f,{type:"textarea",modelValue:e.remark,"onUpdate:modelValue":o[4]||(o[4]=l=>e.remark=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue","loading"])}}});export{P as _};
